<div class="object-view-container">
  <!-- toolbar -->
  <mat-toolbar class="toolbar">
    <span><mat-icon>list_alt</mat-icon></span>
    <span class="spacer"></span>

    <!-- expand/collapse all -->
    <button
      type="button"
      mat-icon-button
      (click)="handleExpandAll()"
      matTooltip="Expand All"
    >
      <mat-icon>unfold_more</mat-icon>
    </button>
    <button
      type="button"
      mat-icon-button
      (click)="handleCollapseAll()"
      matTooltip="Collapse All"
    >
      <mat-icon>unfold_less</mat-icon>
    </button>

    <!-- settings panel toggle -->
    <button
      type="button"
      mat-icon-button
      (click)="handleToggleSettingsPanel()"
      matTooltip="Settings"
    >
      <mat-icon>settings</mat-icon>
    </button>
  </mat-toolbar>

  <!-- settings panel -->
  <mat-expansion-panel
    [expanded]="settingsPanelExpanded()"
    class="settings-panel"
  >
    <mat-expansion-panel-header>
      <mat-panel-title><mat-icon>filter_alt</mat-icon></mat-panel-title>
    </mat-expansion-panel-header>

    <div class="settings-content">
      <!-- search filters -->
      <div class="filter-section form-row">
        <mat-form-field appearance="outline">
          <mat-label>name</mat-label>
          <input
            matInput
            [ngModel]="nameFilter()"
            (input)="handleNameFilterChange($event)"
          />
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>value</mat-label>
          <input
            matInput
            [ngModel]="valueFilter()"
            (input)="handleValueFilterChange($event)"
          />
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
      </div>

      <!-- hide options -->
      <fieldset>
        <legend>hide properties</legend>
        <div class="form-row">
          <mat-checkbox
            [ngModel]="currentFilterSettings().hideEmptyArrays"
            (change)="handleFilterSettingChange('hideEmptyArrays', $event.checked)"
          >
            empty arrays
          </mat-checkbox>
          <mat-checkbox
            [ngModel]="currentFilterSettings().hideEmptyObjects"
            (change)="handleFilterSettingChange('hideEmptyObjects', $event.checked)"
          >
            empty objects
          </mat-checkbox>
          <mat-checkbox
            [ngModel]="currentFilterSettings().hideEmptyStrings"
            (change)="handleFilterSettingChange('hideEmptyStrings', $event.checked)"
          >
            empty strings
          </mat-checkbox>
          <mat-checkbox
            [ngModel]="currentFilterSettings().hideZeroNumbers"
            (change)="handleFilterSettingChange('hideZeroNumbers', $event.checked)"
          >
            zero numbers
          </mat-checkbox>
          <mat-checkbox
            [ngModel]="currentFilterSettings().hideFalseBooleans"
            (change)="handleFilterSettingChange('hideFalseBooleans', $event.checked)"
          >
            false booleans
          </mat-checkbox>
        </div>
      </fieldset>
    </div>
  </mat-expansion-panel>

  <!-- data table -->
  <div class="table-container">
    <table mat-table [dataSource]="displayedNodes()" class="data-table">
      <!-- name column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>name</th>
        <td
          mat-cell
          *matCellDef="let node"
          [style.padding-left.px]="node.level * 20"
        >
          <div class="name-cell">
            <button
              type="button"
              *ngIf="node.type !== 'primitive'"
              mat-icon-button
              (click)="handleToggleNode(node)"
              class="expand-button"
            >
              <mat-icon
                >{{ node.expanded ? 'expand_less' : 'expand_more' }}</mat-icon
              >
            </button>
            <span
              class="name-text"
              [class.highlighted]="isNameHighlighted(node.key)"
            >
              {{ node.key }}
            </span>
          </div>
        </td>
      </ng-container>

      <!-- value column -->
      <ng-container matColumnDef="value">
        <th mat-header-cell *matHeaderCellDef>value</th>
        <td mat-cell *matCellDef="let node">
          <div
            class="value-cell"
            (click)="handleCopyValue(node)"
            [class.clickable]="node.type === 'primitive'"
          >
            <span
              class="value-text"
              [class.highlighted]="isValueHighlighted(getDisplayValue(node))"
              [class.object-count]="node.type !== 'primitive'"
            >
              {{ getDisplayValue(node) }}
            </span>
            <mat-icon
              *ngIf="node.type !== 'primitive'"
              class="expand-all-icon"
              (click)="handleToggleNodeRecursive(node, $event)"
              matTooltip="Expand/Collapse All Descendants"
            >
              {{ node.expanded ? 'unfold_less' : 'unfold_more' }}
            </mat-icon>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns()"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns();"></tr>
    </table>
  </div>
</div>
